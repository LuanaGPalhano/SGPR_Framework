<!DOCTYPE html>
<html lang="pt-BR" xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Cadastro de Medidas do Paciente</title>
    <style>
        /* Estilos gerais */
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 0;
            background-color: #f4f4f4;
            color: #333;
        }

        /* Fundo com gradiente circular */
        body::before {
            content: "";
            position: fixed;
            top: 50%;
            left: 0%;
            width: 100%;
            height: 100%;
            background: radial-gradient(circle at left center, #E9FFF1, #006400);
            clip-path: circle(50% at 25% 50%);
            transform: translateY(-50%);
            z-index: -1;
        }

        /* Layout do formulário */
        .container {
            position: relative;
            max-width: 600px;
            margin: 3% auto;
            padding: 2rem;
            background-color: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            box-shadow: 0 0 20px rgba(0, 0, 0, 0.2);
        }

        h2 {
            text-align: center;
            color: #006400;
            margin-bottom: 1.5rem;
        }

        /* Campos */
        .form-group {
            margin-bottom: 1rem;
        }

        label {
            display: block;
            margin-bottom: 5px;
            font-weight: bold;
        }

        input[type="number"],
        input[type="date"],
        textarea {
            width: 100%;
            padding: 10px;
            border: 1px solid #ccc;
            border-radius: 8px;
            box-sizing: border-box;
        }

        textarea {
            resize: vertical;
            min-height: 80px;
        }

        /* Botões */
        .buttons {
            display: flex;
            justify-content: flex-end;
            gap: 15px;
            margin-top: 2rem;
        }

        .btn-cancelar, .btn-salvar {
            padding: 12px 25px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            font-size: 1rem;
            text-decoration: none;
            text-align: center;
        }

        .btn-cancelar {
            background-color: #f1f1f1;
            color: #333;
            border: 1px solid #ccc;
        }

        .btn-salvar {
            background-color: #006400;
            color: white;
        }
    </style>
</head>
<body>
<div class="container">
    <h2>Cadastro de Medidas</h2>

    <form id="formMedidas" th:action="@{/medidas/salvar}" method="post">
        <input type="hidden" id="pacienteId" name="pacienteId" th:value="${paciente.id}">

        <div class="form-group">
            <label for="dataMedicao">Data da Medição</label>
            <input type="date" id="dataMedicao" name="dataMedicao" required>
        </div>

        <div class="form-group">
            <label for="peso">Peso (kg)</label>
            <input type="number" id="peso" name="peso" step="0.01" placeholder="Ex: 70.5" required>
        </div>

        <div class="form-group">
            <label for="altura">Altura (m)</label>
            <input type="number" id="altura" name="altura" step="0.01" placeholder="Ex: 1.75" required>
        </div>

        <div class="form-group">
            <label for="imc">IMC</label>
            <input type="number" id="imc" name="imc" step="0.01" placeholder="Calculado automaticamente" readonly>
        </div>

        <div class="form-group">
            <label for="percentualGordura">% de Gordura Corporal</label>
            <input type="number" id="percentualGordura" name="percentualGordura" step="0.1" placeholder="Ex: 18.5">
        </div>

        <div class="form-group">
            <label for="circunferenciaCintura">Circunferência da Cintura (cm)</label>
            <input type="number" id="circunferenciaCintura" name="circunferenciaCintura" step="0.1" placeholder="Ex: 82.5">
        </div>

        <div class="form-group">
            <label for="circunferenciaQuadril">Circunferência do Quadril (cm)</label>
            <input type="number" id="circunferenciaQuadril" name="circunferenciaQuadril" step="0.1" placeholder="Ex: 96.0">
        </div>

        <div class="form-group">
            <label for="observacoes">Observações</label>
            <textarea id="observacoes" name="observacoes" placeholder="Observações sobre a medição..."></textarea>
        </div>

        <div class="buttons">
            <a th:href="@{'/paciente/' + ${paciente.id} + '/ficha'}" class="btn-cancelar">Cancelar</a>
            <button type="submit" class="btn-salvar">Salvar Medidas</button>
        </div>
    </form>
</div>

<script>
    // Calcula IMC automaticamente ao preencher peso e altura
    const pesoInput = document.getElementById('peso');
    const alturaInput = document.getElementById('altura');
    const imcInput = document.getElementById('imc');

    function calcularIMC() {
        const peso = parseFloat(pesoInput.value);
        const altura = parseFloat(alturaInput.value);
        if (peso && altura) {
            const imc = peso / (altura * altura);
            imcInput.value = imc.toFixed(2);
        }
    }

    pesoInput.addEventListener('input', calcularIMC);
    alturaInput.addEventListener('input', calcularIMC);

    // Preenche ID do paciente da URL
    window.onload = function() {
        const urlParams = new URLSearchParams(window.location.search);
        const pacienteIdFromUrl = urlParams.get('id');
        if (pacienteIdFromUrl) {
            document.getElementById("pacienteId").value = pacienteIdFromUrl;
        } else {
            alert("ID do paciente não encontrado na URL!");
        }
    };
</script>

</body>
</html>
